(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(r){if(r.ep)return;r.ep=!0;const i=n(r);fetch(r.href,i)}})();function u(t,e){const n={};return n.vnode=!0,n.type=t,n.props=e||{},n.children=[].concat.apply([],[].slice.call(arguments,2)),n.isInstance=t&&t.template&&typeof t.template=="function",n.isComponent=typeof t=="function"&&t.prototype&&typeof t.prototype.render=="function",n.isStateless=typeof t=="function"&&!n.isComponent,n.isDom=typeof t=="string",n}u.f=t=>t.children;function $e(t,e){for(const n in e)t[n]=e[n];return t}function N(){}function Ht(t,e,n,s){if(s)return{log:N,warn:N,error:N};const r=[];t=t.toUpperCase(),r.push(`%c ${t} `);let i="font-weight:bold;";return e&&(i+=`color:${e};`),n&&(i+=`background-color:${n}`),r.push(i),{log:console.log.bind(console,...r),warn:console.warn.bind(console,...r),error:console.error.bind(console,...r)}}const it=["nodes","components","refs","domEvents","storeEvents"];class ne{constructor(){this.data={};for(let e=0;e<it.length;e++)this.data[it[e]]=[]}append(e){for(const n in e)this.data[n]=this.data[n].concat(e[n])}set(e){for(const n in e)this.data[n]=e[n]}get(){return this.data}}const ye=["xlink","xmlns","xml"],$t=new Set(["placeholder","autoplay","muted","for","webkit-playsinline","playsinline","selected"]);let Te;const J=(t,e)=>t.substr(0,e.length)===e,Vt=t=>(e,n)=>n.classList.toggle(t,e||!1),Be=(t="textContent",e)=>(n,s)=>{e&&t!==(t=t.replace(/^xlink:?/,""))?s.setAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase(),n):(Te=n??"",e||(s[t]=Te),(e||$t.has(t)||J(t,"data-"))&&s.setAttribute(t,Te))};function Wt(t,e,n,s,r){if(n!==void 0&&!(e==="__self"||e==="__source")){e==="className"&&(e="class");for(let i=0;i<ye.length;i++)if(J(e,ye[i])){const o=ye[i].length;e[o]&&e[o]!==":"&&(e=ye[i]+":"+e[o].toLowerCase()+e.substr(o+1,e.length));break}if(e!=="ref"){if(J(e,"event-")){const i=e.toLowerCase().substring(6);s.append({domEvents:[{el:t,evt:i,fn:n}]})}else if(e==="store"){const i=Array.isArray(n)?n:[n],o=[];for(let l=0,c=i.length;l<c;l++){const f=Array.isArray(i[l])?i[l]:[i[l]],d=f[0],w=f[1],C=f[2]!==void 0?f[2]:!0;d&&o.push({store:d,fn:w,init:C,el:t})}s.append({storeEvents:o})}else if(J(e,"store-class-")){const i=e.substring(12),o=Vt(i);s.append({storeEvents:[{store:n,init:!0,fn:o,el:t}]})}else if(J(e,"store-")){let i=e.substring(6);i==="text"&&(i="textContent");const o=Be(i,r);s.append({storeEvents:[{store:n,init:!0,fn:o,el:t}]})}else if(!(typeof n=="function"&&J(e,"on")))if(e==="class"&&!r)t.className=n||"";else if(e==="style")typeof n=="object"?$e(t.style,n):typeof n=="string"&&(t.style.cssText=n);else if(e!=="list"&&e!=="type"&&!r&&e in t)try{Be(e,r)(n,t)}catch{}else typeof n!="object"&&typeof n!="function"&&Be(e,r)(n,t)}}}function Ut(t){return Array.isArray(t)?t:[t]}function ge(t,e){if(Array.isArray(t))return Zt(t,e);if(t instanceof window.Element)return Yt(t);if(t===null||typeof t!="object"||!t.vnode)return qt(t);const n=$e($e({},t.props),{children:[].concat.apply([],t.children||[])});if(t.isDom)return zt(t,n,e);if(t.isInstance)return ot(t,n,e,!0);if(t.isStateless)return Jt(t,n,e);if(t.isComponent)return ot(t,n,e)}function Zt(t,e){t=Ut(t);const n=new ne;for(let s=0;s<t.length;s++)n.append(ge(t[s],e));return n.get()}function qt(t){const e=new ne;return t==null||t===!1||e.append({nodes:document.createTextNode(t+"")}),e.get()}function zt(t,e,n){const s=new ne;let r=[];t.type==="svg"&&(n=!0);for(let o=0;o<e.children.length;o++){const l=ge(e.children[o],n);l.nodes&&(r=r.concat(l.nodes),s.append({components:l.components,refs:l.refs,domEvents:l.domEvents,storeEvents:l.storeEvents}))}const i=n?document.createElementNS("http://www.w3.org/2000/svg",t.type):document.createElement(t.type);for(const o in t.props)Wt(i,o,t.props[o],s,n);for(let o=0;o<r.length;o++)i.appendChild(r[o]);return e.ref&&s.append({refs:{ref:i,fn:e.ref}}),s.append({nodes:i}),s.get()}function Yt(t){const e=new ne;return e.append({nodes:t}),e.get()}function Jt(t,e,n){const s=new ne,r=t.type(e);return s.append(ge(r,n)),s.get()}function ot(t,e,n,s=!1){const r=new ne,i=s?t.type:new t.type(e);s&&(e=i.props),i.beforeRender(e);const o=i.template(e,i.state||{});e.ref&&r.append({refs:{ref:i,fn:e.ref}}),r.append(ge(o,n));const l=r.data.nodes;i.base=l.length>1?l:l[0];for(const c in r.data)c!=="nodes"&&(i._collector[c]||(i._collector[c]=[]),i._collector[c]=i._collector[c].concat(r.data[c]));r.set({components:[i],refs:[],domEvents:[],storeEvents:[]});for(let c=0;c<i._collector.components.length;c++)i._collector.components[c]._parent=i;return r.get()}function G(t,e,n){const s=t._collector&&t._collector.components;if(n&&e(t),s)for(let r=0;r<s.length;r++)G(s[r],e);n||e(t)}function Gt(t){for(let e=0;e<t._collector.refs.length;e++)t._collector.refs[e].fn(t._collector.refs[e].ref),t._collector.refs[e].ref=null}function Xt(t){for(let e=0;e<t._collector.storeEvents.length;e++){const n=t._collector.storeEvents[e],s=n.fn;n.fn=function(r){s(r,n.el)},n.store.subscribe(n.fn),n.init&&n.fn(n.store.current)}}function Qt(t){t.test&&console.log("call dom listeners",t._collector.domEvents);for(let e=0;e<t._collector.domEvents.length;e++){const n=t._collector.domEvents[e];n.el.addEventListener(n.evt,n.fn)}}function en(t){G(t,Gt)}function tn(t){G(t,Qt),G(t,Xt)}const nn=new Set(["g","svg","defs"]);function H(t,e=document.body,n){let s=0;const r=ge(t,nn.has(e.tagName));let i={_collector:r};if(en(i),G(i,function(o){o.afterRender&&o.afterRender(o.props)}),typeof e=="function"){const o=r.nodes.length<2?r.nodes[0]:r.nodes;e(o)}else if(e)for(s=0;s<r.nodes.length;s++)e.appendChild(r.nodes[s]);if((!n||n.mounted)&&(tn(i),G(i,function(o){o.mounted=!0,o.afterMount&&o.afterMount(o.props)})),n&&n._collector){const o=n._collector;for(s=0;s<r.components.length;s++)r.components[s]._parent=n;o.refs&&(o.refs=o.refs.concat(r.refs)),o.components&&(o.components=o.components.concat(r.components)),o.domEvents&&(o.domEvents=o.domEvents.concat(r.domEvents)),o.storeEvents&&(o.storeEvents=o.storeEvents.concat(r.storeEvents))}return i=void 0,r}class R{constructor(e={}){this._parent=null,this._collector={refs:[],components:[],domEvents:[],storeEvents:[]},this._storeListeners=[],this.refs={},this.state={},this.store={},this.props=e||{},this.base=null,this.mounted=!1,this.destroyed=!1;const n=e.name||this.constructor.name||"Component",{log:s,warn:r,error:i}=Ht(n,"white","#000",e.disableLog);this.log=s,this.warn=r,this.error=i}storeSubscribe(e,n,s,r=!0){e.subscribe(n,s),this._storeListeners.push([e,n,s]),r&&n.call(s,e.current)}template(){}beforeRender(){}afterRender(){}afterMount(){}beforeDestroy(){}ref(e){const n=this;return function(r){n.refs[e]=r}}refArray(e,n=!1){const s=this.refs[e]||(this.refs[e]=[]);let r=s.length,i,o;return n&&(i=this.refs.__pools||(this.refs.__pools={}),o=i[e]||(i[e]=[]),o.length&&(r=o.pop())),s[r]=null,function(c){s[r]=c,n&&o.push(r)}}refMap(e,n){const s=this.refs[n]||(this.refs[n]=new Map);return function(i){i?s.set(e,i):s.delete(e)}}render(e,n){return H(e,n,this)}destroy(){let e=0;for(this.beforeDestroy(this.props),e=this._collector.domEvents.length-1;e>=0;e--){const s=this._collector.domEvents[e];s.el.removeEventListener(s.evt,s.fn)}for(e=this._collector.storeEvents.length-1;e>=0;e--){const s=this._collector.storeEvents[e];s.store.unsubscribe(s.fn)}for(e=this._storeListeners.length-1;e>=0;e--){const s=this._storeListeners[e];s[0].unsubscribe(s[1],s[2])}for(e=this._collector.components.length-1;e>=0;e--)this._collector.components[e].destroy();if(this.mounted=!1,this.destroyed=!0,this._parent){const s=this._parent._collector.components.indexOf(this);~s&&this._parent._collector.components.splice(s,1),this._parent=null}for(e=this._collector.refs.length-1;e>=0;e--)this._collector.refs[e].fn(null),this._collector.refs.splice(e,1);let n=Array.isArray(this.base)?this.base:[this.base];for(e=0;e<n.length;e++)n[e]&&n[e].parentNode&&n[e].parentNode.removeChild(n[e]);this.base=n=null,this.props=null,this.state=null,this.store=null,this.refs=null,this._storeListeners=null}}function lt(t,e,n,s){this.fn=e,this.ctx=n||null,this.owner=t,this.once=!!s}function Se(t,e){e.prev&&(e.prev.next=e.next),e.next&&(e.next.prev=e.prev),e.ctx=e.fn=e.owner=null,e===t._first&&(t._first=e.next),e===t._last&&(t._last=e.prev)}class sn{constructor(){this._first=this._last=null}dispatch(e,n,s,r,i){let o=this._first;for(;o;)o.fn.call(o.ctx,e,n,s,r,i),o.once&&this.unsubscribe(o),o=o.next}subscribe(e,n,s){const r=new lt(this,e,n,s);return this._first?(this._last.next=r,r.prev=this._last,this._last=r):(this._first=r,this._last=r),r}subscribeOnce(e,n){return this.subscribe(e,n,!0)}unsubscribe(e,n){if(e instanceof lt)return Se(this,e);n||(n=null);let s=this._first;for(;s;)s.fn===e&&s.ctx===n&&Se(this,s),s=s.next}unsubscribeAll(){let e=this._first;for(this._first=this._last=null;e;)Se(this,e),e=e.next}}class kt extends sn{constructor(e){super(),this.current=e}set(){throw new Error("Cannot set a different value for a Readable Signal. Use Writable instead")}get(){return this.current}}function A(t){return new kt(t)}class Mt extends kt{set(e,n){if(!n&&this.current===e)return;this.previous=this.current,this.current=e;let s=this._first;for(;s;)s.fn.call(s.ctx,this.current,this.previous),s.once&&this.unsubscribe(s),s=s.next}update(e,n){const s=e(this.current);this.set(s!==void 0?s:this.current,n)}}function M(t){return new Mt(t)}function X(t,e){const n=new Mt,s=n.set.bind(n);delete n.set;const r=Array.isArray(t);let i=r?new Array(t.length):null;if(r)for(let l=0,c=t.length;l<c;l++)i[l]=t[l].current,t[l].subscribe(function(f){i[l]=f,o()});else i=t.current,t.subscribe(function(l){i=l,o()});o();function o(){const l=e(i);l&&l.then?l.then(s):s(l)}return n}const at=t=>X(t,e=>!e),rn=`<svg width="24" height="24" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M12 14C13.1046 14 14 13.1046 14 12C14 10.8954 13.1046 10 12 10C10.8954 10 10 10.8954 10 12C10 13.1046 10.8954 14 12 14Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M21 12C19.1114 14.991 15.7183 18 12 18C8.2817 18 4.88856 14.991 3 12C5.29855 9.15825 7.99163 6 12 6C16.0084 6 18.7015 9.1582 21 12Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
`,on=`<svg width="24" height="24" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M3 3L21 21" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M10.5 10.6771C10.1888 11.0296 10 11.4928 10 12C10 13.1045 10.8954 14 12 14C12.5072 14 12.9703 13.8112 13.3229 13.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M7.36185 7.5611C5.68002 8.73968 4.27894 10.4188 3 12C4.88856 14.991 8.2817 18 12 18C13.5499 18 15.0434 17.4772 16.3949 16.6508" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M12 6C16.0084 6 18.7015 9.1582 21 12C20.6815 12.5043 20.3203 13.0092 19.922 13.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
`,ln=`<svg width="24" height="24" viewBox="0 0 24 24" stroke-width="1.5" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M19.5 16L17.0248 12.6038" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M12 17.5V14" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M4.5 16L6.96895 12.6124" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M3 8C6.6 16 17.4 16 21 8" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
`,_t=`<svg width="24" height="24" viewBox="0 0 24 24" stroke-width="1.5" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M14.3632 5.65156L15.8431 4.17157C16.6242 3.39052 17.8905 3.39052 18.6716 4.17157L20.0858 5.58579C20.8668 6.36683 20.8668 7.63316 20.0858 8.41421L18.6058 9.8942M14.3632 5.65156L4.74749 15.2672C4.41542 15.5993 4.21079 16.0376 4.16947 16.5054L3.92738 19.2459C3.87261 19.8659 4.39148 20.3848 5.0115 20.33L7.75191 20.0879C8.21972 20.0466 8.65806 19.8419 8.99013 19.5099L18.6058 9.8942M14.3632 5.65156L18.6058 9.8942" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
`,an=`<svg width="24" height="24" viewBox="0 0 24 24" stroke-width="1.5" fill="none" xmlns="http://www.w3.org/2000/svg">
<g clip-path="url(#clip0_2585_14438)">
<path d="M17.6744 11.4075L15.7691 17.1233C15.7072 17.309 15.5586 17.4529 15.3709 17.5087L3.69348 20.9803C3.22819 21.1186 2.79978 20.676 2.95328 20.2155L6.74467 8.84131C6.79981 8.67588 6.92419 8.54263 7.08543 8.47624L12.472 6.25822C12.696 6.166 12.9535 6.21749 13.1248 6.38876L17.5294 10.7935C17.6901 10.9542 17.7463 11.1919 17.6744 11.4075Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M3.2959 20.6016L9.65986 14.2376" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M17.7917 11.0557L20.6202 8.22724C21.4012 7.44619 21.4012 6.17986 20.6202 5.39881L18.4989 3.27749C17.7178 2.49645 16.4515 2.49645 15.6704 3.27749L12.842 6.10592" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M11.7814 12.1163C11.1956 11.5305 10.2458 11.5305 9.66004 12.1163C9.07426 12.7021 9.07426 13.6519 9.66004 14.2376C10.2458 14.8234 11.1956 14.8234 11.7814 14.2376C12.3671 13.6519 12.3671 12.7021 11.7814 12.1163Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>
</g>
<defs>
<clipPath id="clip0_2585_14438">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>
</svg>
`,a={AA_AB_FILL_MODE_LENGTH:A(3),LINE_WIDTHS:A([{value:10,name:"medium"},{value:20,name:"large"},{value:5,name:"small"}]),COLORS:A([{value:"#FFF1E8"},{value:"#FF004D"},{value:"#FFA300"},{value:"#FFEC27"},{value:"#00E436"},{value:"#29ADFF"},{value:"#83769C"},{value:"#FF77A8"},{value:"#FFCCAA"}]),FILL_MODES:A([{value:"AA→AB"},{value:"AA→BB"},{value:"AA→AB→BB"},{value:"AB"}]),VIEW_MODES:A([{value:"wireframe",icon:rn},{value:"preview",icon:on},{value:"no-ui",icon:ln}]),DRAW_MODES:A([{value:"smooth",icon:_t},{value:"freehand",icon:an}]),app:{drawMode:M("freehand"),inputMode:M("draw"),fillMode:M("AA→AB"),viewMode:M("wireframe"),lines:M([]),style:M({lineWidth:10,strokeStyle:"white",lineJoin:"round",lineCap:"round"})},raf:{fps:A(60),maxDuration:A(60*5),isRunning:M(!1),frameCount:M(0)},api:{url:A("https://toools-gcr-service-tnoires-ew9-prd-htddyedwxa-od.a.run.app"),pollingInterval:A(1e3),pollingMaxAttempts:A(30),version:M(null)}};window.Store=a;function ct(t,e,n,s=r=>r){return t*s(.5-e*(.5-n))}function cn(t){return[-t[0],-t[1]]}function D(t,e){return[t[0]+e[0],t[1]+e[1]]}function E(t,e){return[t[0]-e[0],t[1]-e[1]]}function O(t,e){return[t[0]*e,t[1]*e]}function un(t,e){return[t[0]/e,t[1]/e]}function le(t){return[t[1],-t[0]]}function ut(t,e){return t[0]*e[0]+t[1]*e[1]}function fn(t,e){return t[0]===e[0]&&t[1]===e[1]}function dn(t){return Math.hypot(t[0],t[1])}function hn(t){return t[0]*t[0]+t[1]*t[1]}function ft(t,e){return hn(E(t,e))}function xt(t){return un(t,dn(t))}function pn(t,e){return Math.hypot(t[1]-e[1],t[0]-e[0])}function ae(t,e,n){let s=Math.sin(n),r=Math.cos(n),i=t[0]-e[0],o=t[1]-e[1],l=i*r-o*s,c=i*s+o*r;return[l+e[0],c+e[1]]}function Ve(t,e,n){return D(t,O(E(e,t),n))}function dt(t,e,n){return D(t,O(e,n))}var{min:z,PI:gn}=Math,ht=.275,ce=gn+1e-4;function vn(t,e={}){let{size:n=16,smoothing:s=.5,thinning:r=.5,simulatePressure:i=!0,easing:o=h=>h,start:l={},end:c={},last:f=!1}=e,{cap:d=!0,easing:w=h=>h*(2-h)}=l,{cap:C=!0,easing:y=h=>--h*h*h+1}=c;if(t.length===0||n<=0)return[];let p=t[t.length-1].runningLength,k=l.taper===!1?0:l.taper===!0?Math.max(n,p):l.taper,se=c.taper===!1?0:c.taper===!0?Math.max(n,p):c.taper,tt=Math.pow(n*s,2),re=[],q=[],Le=t.slice(0,10).reduce((h,_)=>{let v=_.pressure;if(i){let m=z(1,_.distance/n),Pe=z(1,1-m);v=z(1,h+(Pe-h)*(m*ht))}return(h+v)/2},t[0].pressure),L=ct(n,r,t[t.length-1].pressure,o),Ae,Ee=t[0].vector,ie=t[0].point,ve=ie,V=ie,W=ve,Oe=!1;for(let h=0;h<t.length;h++){let{pressure:_}=t[h],{point:v,vector:m,distance:Pe,runningLength:oe}=t[h];if(h<t.length-1&&p-oe<3)continue;if(r){if(i){let I=z(1,Pe/n),je=z(1,1-I);_=z(1,Le+(je-Le)*(I*ht))}L=ct(n,r,_,o)}else L=n/2;Ae===void 0&&(Ae=L);let It=oe<k?w(oe/k):1,Kt=p-oe<se?y((p-oe)/se):1;L=Math.max(.01,L*Math.min(It,Kt));let nt=(h<t.length-1?t[h+1]:t[h]).vector,Re=h<t.length-1?ut(m,nt):1,Nt=ut(m,Ee)<0&&!Oe,st=Re!==null&&Re<0;if(Nt||st){let I=O(le(Ee),L);for(let je=1/13,me=0;me<=1;me+=je)V=ae(E(v,I),v,ce*me),re.push(V),W=ae(D(v,I),v,ce*-me),q.push(W);ie=V,ve=W,st&&(Oe=!0);continue}if(Oe=!1,h===t.length-1){let I=O(le(m),L);re.push(E(v,I)),q.push(D(v,I));continue}let rt=O(le(Ve(nt,m,Re)),L);V=E(v,rt),(h<=1||ft(ie,V)>tt)&&(re.push(V),ie=V),W=D(v,rt),(h<=1||ft(ve,W)>tt)&&(q.push(W),ve=W),Le=_,Ee=m}let S=t[0].point.slice(0,2),F=t.length>1?t[t.length-1].point.slice(0,2):D(t[0].point,[1,1]),De=[],we=[];if(t.length===1){if(!(k||se)||f){let h=dt(S,xt(le(E(S,F))),-(Ae||L)),_=[];for(let v=1/13,m=v;m<=1;m+=v)_.push(ae(h,S,ce*2*m));return _}}else{if(!(k||se&&t.length===1))if(d)for(let _=1/13,v=_;v<=1;v+=_){let m=ae(q[0],S,ce*v);De.push(m)}else{let _=E(re[0],q[0]),v=O(_,.5),m=O(_,.51);De.push(E(S,v),E(S,m),D(S,m),D(S,v))}let h=le(cn(t[t.length-1].vector));if(se||k&&t.length===1)we.push(F);else if(C){let _=dt(F,h,L);for(let v=1/29,m=v;m<1;m+=v)we.push(ae(_,F,ce*3*m))}else we.push(D(F,O(h,L)),D(F,O(h,L*.99)),E(F,O(h,L*.99)),E(F,O(h,L)))}return re.concat(we,q.reverse(),De)}function wn(t,e={}){var n;let{streamline:s=.5,size:r=16,last:i=!1}=e;if(t.length===0)return[];let o=.15+(1-s)*.85,l=Array.isArray(t[0])?t:t.map(({x:y,y:p,pressure:k=.5})=>[y,p,k]);if(l.length===2){let y=l[1];l=l.slice(0,-1);for(let p=1;p<5;p++)l.push(Ve(l[0],y,p/4))}l.length===1&&(l=[...l,[...D(l[0],[1,1]),...l[0].slice(2)]]);let c=[{point:[l[0][0],l[0][1]],pressure:l[0][2]>=0?l[0][2]:.25,vector:[1,1],distance:0,runningLength:0}],f=!1,d=0,w=c[0],C=l.length-1;for(let y=1;y<l.length;y++){let p=i&&y===C?l[y].slice(0,2):Ve(w.point,l[y],o);if(fn(w.point,p))continue;let k=pn(p,w.point);if(d+=k,y<C&&!f){if(d<r)continue;f=!0}w={point:p,pressure:l[y][2]>=0?l[y][2]:.5,vector:xt(E(w.point,p)),distance:k,runningLength:d},c.push(w)}return c[0].vector=((n=c[1])==null?void 0:n.vector)||[0,0],c}function mn(t,e={}){return vn(wn(t,e),e)}var yn=function(e,n){return e[0]=n[0],e[1]=n[1],e},pt=yn,gt=function(t,e){Array.isArray(e)||(e=[]),t.length>0&&e.push(pt([0,0],t[0]));for(var n=0;n<t.length-1;n++){var s=t[n],r=t[n+1],i=s[0],o=s[1],l=r[0],c=r[1],f=[.75*i+.25*l,.75*o+.25*c],d=[.25*i+.75*l,.25*o+.75*c];e.push(f),e.push(d)}return t.length>1&&e.push(pt([0,0],t[t.length-1])),e};class ze{constructor({points:e=[],drawMode:n="raw",fillMode:s="AA→AB",firstFrame:r=0,style:i={}}={}){this.points=e,this.drawMode=n,this.fillMode=s,this.firstFrame=r,this.style=i}get isEmpty(){return!this.points||!this.points.length}push(e){this.points.push(e)}render(e,{frame:n=Number.POSITIVE_INFINITY,drawMode:s=this.drawMode,fillMode:r=this.fillMode,style:i=this.style,preferSprite:o=!0}={}){if(this.isEmpty||n<this.firstFrame&&r!=="AB")return;if(e.save(),r==="AB"&&o){this.sprite||(this.sprite=this.toSprite(e,{drawMode:s,fillMode:r,style:i})),e.drawImage(this.sprite,0,0),e.restore();return}e.beginPath();for(const[f,d]of Object.entries(i))f==="lineDash"&&e.setLineDash(d),e[f]=d;const l=[];switch(r){case"AB":l[0]=0,l[1]=this.points.length;break;case"AA→AB":l[0]=0,l[1]=n-this.firstFrame;break;case"AA→BB":l[0]=Math.max(0,n-this.firstFrame-a.AA_AB_FILL_MODE_LENGTH.get()),l[1]=n-this.firstFrame;break;case"AA→AB→BB":l[0]=Math.max(0,n-this.firstFrame-this.points.length/2),l[1]=n-this.firstFrame;break}const c=(()=>{const f=this.points.slice(l[0],l[1]);return s==="smooth"?gt(f):s==="freehand"?mn(gt(f),{size:i.lineWidth*1.5,thinning:.5,smoothing:.01,streamline:.6}):f})();for(let f=0;f<c.length;f++){const d=c[f];d&&e[f?"lineTo":"moveTo"](d[0],d[1])}s==="freehand"?(e.fillStyle=e.strokeStyle,e.fill()):e.stroke(),e.restore()}toSprite(e,n){const s=document.createElement("canvas");return s.width=e.canvas.width,s.height=e.canvas.height,this.render(s.getContext("2d"),{...n,preferSprite:!1}),s}toJSON(){return{points:this.points,drawMode:this.drawMode,fillMode:this.fillMode,firstFrame:this.firstFrame,style:this.style}}}function We(t,e,n){var s,r,i,o,l;e==null&&(e=100);function c(){var d=Date.now()-o;d<e&&d>=0?s=setTimeout(c,e-d):(s=null,n||(l=t.apply(i,r),i=r=null))}var f=function(){i=this,r=arguments,o=Date.now();var d=n&&!s;return s||(s=setTimeout(c,e)),d&&(l=t.apply(i,r),i=r=null),l};return f.clear=function(){s&&(clearTimeout(s),s=null)},f.flush=function(){s&&(l=t.apply(i,r),i=r=null,clearTimeout(s),s=null)},f}We.debounce=We;var bn=We;class Lt extends R{beforeRender(e){this.handleResize=this.handleResize.bind(this),this.state={dpr:A(e.dpr||window.devicePixelRatio||1)}}template(){return u("canvas",{class:"canvas",ref:this.ref("canvas")})}afterMount(){this.context=this.refs.canvas.getContext("2d"),this.handleResize(),window.addEventListener("resize",bn(this.handleResize,100))}clear(){this.context.clearRect(0,0,this.refs.canvas.width,this.refs.canvas.height)}handleResize(){const e=this.state.dpr.get(),{width:n,height:s}=this.refs.canvas.getBoundingClientRect();this.refs.canvas.width=n*e,this.refs.canvas.height=s*e,this.context.scale(e,e)}}function Cn(t,e){if(e===void 0)throw new Error("You must specify a callback");t===void 0&&(t=30);var n=1e3/t,s=0,r=0;return function(i){s-=i,r+=i,s<=0&&(e(r),r=0,s=n+s%n)}}var ke=typeof window>"u"?global:window,U=[],Q=[],ee=[],$=null,Z=null,ue=!1,Ye=!1,Je,K;function Ce(t){t===void 0&&(t=0),Z===null&&(Z=t),K=t-Z,Je+=K,Z=t,$=ue?null:ke.requestAnimationFrame(Ce),ue&&(ue=!1);var e;if(Ye){for(e=0;e<ee.length;e++)ee[e](K);for(e=0;e<U.length;e++)U[e](K);for(e=0;e<Q.length;e++)Q[e](K)}else for(e=0;e<U.length;e++)U[e](K)}function Me(){Ye=Q.length>0||ee.length>0}function Ge(t,e,n){return!e||!t||~t.indexOf(e)?!1:(n=!!n,n?t.unshift(e):t.push(e),!0)}function Xe(t,e){if(!e)return!1;var n=t.indexOf(e);return~n?(t.splice(n,1),t.length===0):!1}function kn(t,e){Ge(ee,t,e)&&Me()}function Mn(t,e){Ge(Q,t,e)&&Me()}function _n(t,e){Ge(U,t,e)&&At()}function xn(t){Xe(ee,t)&&Me()}function Ln(t,e){Xe(Q,t)&&Me()}function An(t){Xe(U,t)&&Qe()}function At(t){ue=!1,!$&&(t=!!t,Z=null,t?Ce():$=ke.requestAnimationFrame(Ce))}function En(){$||(ue=!0,Z=null,$=ke.requestAnimationFrame(Ce))}function Qe(){$&&(ke.cancelAnimationFrame($),$=null)}function On(){Qe(),U.length=0,Q.length=0,ee.length=0,Ye=!1,Z=null,Je=0,K=0}const Et={add:_n,addAfter:Mn,addBefore:kn,remove:An,removeAfter:Ln,removeBefore:xn,start:At,stop:Qe,time:Je,dt:K,requestOnce:En,dispose:On},Dn=()=>{a.raf.frameCount.update(t=>++t%a.raf.maxDuration.get())},Ot=Cn(a.raf.fps.current,Dn);function Dt(){a.raf.isRunning.set(!0),Et.add(Ot)}function Pt(){a.raf.isRunning.set(!1),Et.remove(Ot)}function Pn(){a.raf.isRunning.update(t=>!t),a.raf.isRunning.get()?Dt():Pt()}const P={start:Dt,stop:Pt,toggle:Pn},Ue=t=>{if(window.TouchEvent&&t instanceof TouchEvent){const e=t.targetTouches[0];return e?[e.clientX,e.clientY]:[-1,-1]}return t.pointerType==="pen"?[t.clientX,t.clientY,t.pressure]:[t.clientX,t.clientY]};let Rn=class extends R{beforeRender(e){this.update=this.update.bind(this),this.handleTick=this.handleTick.bind(this),this.handlePointerDown=this.handlePointerDown.bind(this),this.handlePointerMove=this.handlePointerMove.bind(this),this.handlePointerUp=this.handlePointerUp.bind(this),this.state={isDisabled:e["store-disabled"]||M(e.disabled),penDown:M(!1),penPosition:M([-1,-1]),line:M(null)}}template(e,n){return u("section",{class:"drawer","store-class-has-pen-down":n.penDown,"store-class-is-disabled":n.isDisabled,"event-pointerDown":this.handlePointerDown,"event-pointerMove":this.handlePointerMove,"event-pointerUp":this.handlePointerUp,style:"touch-action: none"},u(Lt,{ref:this.ref("canvas")}))}afterRender(){this.state.line.subscribe(this.update),a.raf.frameCount.subscribe(this.handleTick)}update(){this.refs.canvas.clear();const e=this.state.line.get();e&&e.render(this.refs.canvas.context,{frame:a.raf.frameCount.get(),fillMode:"AB",preferSprite:!1})}handlePointerDown(e){this.base.setPointerCapture(e.pointerId),this.state.penDown.set(!0),this.state.penPosition.set(Ue(e));const n=new ze({firstFrame:a.raf.frameCount.get(),drawMode:a.app.drawMode.get(),fillMode:a.app.fillMode.get(),style:a.app.style.get()});this.state.line.set(n)}handlePointerMove(e){this.log("move"),this.state.penDown.get()&&(P.start(),this.state.penPosition.set(Ue(e)))}handleTick(){if(!this.state.penDown.get())return;const e=this.state.line.get();if(e){if(e.firstFrame+e.points.length>=a.raf.maxDuration.get()){this.handlePointerUp();return}this.state.line.update(n=>(n.push(this.state.penPosition.get()),n),!0)}}handlePointerUp(e){e&&this.base.releasePointerCapture(e.pointerId),this.state.penDown.set(!1);const n=this.state.line.get();this.state.line.set(null),!(!n||n.isEmpty)&&a.app.lines.update(s=>(s.push(n),s),!0)}};const jn=t=>t[t.length-1];class Tn extends R{beforeRender(e){this.handleClick=this.handleClick.bind(this),this.state={isDisabled:e["store-disabled"]||M(e.disabled)}}template(e,n){return u("section",{class:"paster","store-class-is-disabled":n.isDisabled,"event-click":this.handleClick})}handleClick(e){const n=jn(a.app.lines.get());if(!n)return;const[s,r]=Ue(e),i=n.points[0][0]-s,o=n.points[0][1]-r,l=new ze({points:n.points.map(([c,f])=>[c-i,f-o]),firstFrame:a.raf.frameCount.get(),style:Object.assign({},n.style,a.app.style.current),drawMode:a.app.drawMode.get(),fillMode:a.app.fillMode.get()});P.start(),a.app.lines.update(c=>(c.push(l),c),!0)}}class Bn extends R{beforeRender(){this.handleTick=this.handleTick.bind(this)}template(e,n){return u("section",{class:"renderer"},u(Lt,{ref:this.ref("canvas")}))}afterRender(){a.app.lines.subscribe(this.handleTick),a.app.viewMode.subscribe(this.handleTick),a.raf.frameCount.subscribe(this.handleTick)}handleTick(){this.refs.canvas.clear();const e=a.raf.frameCount.get(),n=a.app.viewMode.get(),{context:s}=this.refs.canvas;for(const r of a.app.lines.get())n==="wireframe"&&r.fillMode!=="AB"&&r.render(s,{fillMode:"AB",drawMode:"smooth",style:{lineWidth:2,strokeStyle:"rgba(255 255 255 / 50%)",lineDash:[10,10]}}),r.render(s,{frame:e,smoothed:!0})}}var fe={},Sn={get exports(){return fe},set exports(t){fe=t}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(t){(function(){var e={}.hasOwnProperty;function n(){for(var s=[],r=0;r<arguments.length;r++){var i=arguments[r];if(i){var o=typeof i;if(o==="string"||o==="number")s.push(i);else if(Array.isArray(i)){if(i.length){var l=n.apply(null,i);l&&s.push(l)}}else if(o==="object"){if(i.toString!==Object.prototype.toString&&!i.toString.toString().includes("[native code]")){s.push(i.toString());continue}for(var c in i)e.call(i,c)&&i[c]&&s.push(c)}}}return s.join(" ")}t.exports?(n.default=n,t.exports=n):window.classNames=n})()})(Sn);class j extends R{beforeRender(e){this.animate=this.animate.bind(this),this.handleClick=this.handleClick.bind(this),this.state={label:e["store-label"]||A(e.label),isWaiting:e["store-is-waiting"]||M(!1),isDisabled:e["store-disabled"]||M(e.disabled),isHidden:e["store-hidden"]||M(e.hidden)}}template(e,n){return u("button",{class:fe("button",e.class),"store-class-is-waiting":n.isWaiting,"store-disabled":n.isDisabled,"store-hidden":n.isHidden,"event-click":this.handleClick,"event-mouseenter":e["event-mouseenter"]||N,"event-mouseleave":e["event-mouseleave"]||N,title:e.title,style:e.style,type:e.type},e.icon&&u("div",{class:"button__icon",ref:this.ref("icon"),innerHTML:e.icon}),u("div",{class:"button__text","store-innerHTML":n.label}))}afterRender(){this.state.isHidden.subscribe(this.animate)}animate(){this&&this.refs&&this.refs.icon&&(this.refs.icon.style.animation="none",this.refs.icon.offsetHeight,this.refs.icon.style.animation=null)}async handleClick(e){if(this.state.isWaiting.get())return e.preventDefault();this.animate(),this.state.isWaiting.set(!0),await(this.props["event-click"]||N)(e),this.mounted&&this.state.isWaiting.set(!1)}}let Fn=t=>crypto.getRandomValues(new Uint8Array(t)),In=(t,e,n)=>{let s=(2<<Math.log(t.length-1)/Math.LN2)-1,r=-~(1.6*s*e/t.length);return(i=e)=>{let o="";for(;;){let l=n(r),c=r;for(;c--;)if(o+=t[l[c]&s]||"",o.length===i)return o}}},Kn=(t,e=21)=>In(t,e,Fn);const Ze=t=>a.api.url.get()+"/api/"+t,Nn={timer:null,attempts:0,start:function(){if(this.stop(),!(!a.api||!a.api.url.get())){if(this.attempts>=a.api.pollingMaxAttempts.get()){console.warn("api max polling attempts reached"),a.api=null,console.error("Impossible de contacter l’API: l’export PDF ne sera pas disponible.");return}this.timer=setTimeout(async()=>{this.attempts++;try{const e=await(await fetch(Ze("version"),{method:"GET"})).json();if(!e||!e.version)throw new Error("Ping malformed");a.api.version.set(e.version)}catch{this.start()}},a.api.pollingInterval.get())}},stop:function(){clearTimeout(this.timer)}},et={polling:Nn,import:async t=>{const e=await fetch(Ze("json/"+t));if(!e.ok&&e.status!==500)throw e;const n=e.json();if(n.error)throw new Error(n.error);return n},export:async(t,e)=>{const n=await fetch(Ze(e?"json?uid="+e:"json"),{method:"PUT",body:JSON.stringify(t)});if(!n.ok&&n.status!==500)throw n;const s=n.json();if(s.error)throw new Error(s.error);return s}};const Rt=`<svg width="24" height="24" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M6.75827 17.2426L12.0009 12M17.2435 6.75736L12.0009 12M12.0009 12L6.75827 6.75736M12.0009 12L17.2435 17.2426" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
`;let _e=class extends R{beforeRender(){this.destroy=this.destroy.bind(this)}template(e){return u("div",{class:"modal__wrapper",...e.bigText&&{"event-click":this.destroy}},u("section",{class:fe("modal",e.class,{"big-text":e.bigText})},u("header",{class:"modal__header"},u("h2",{class:"modal__title"},e.title),u(j,{icon:Rt,"event-click":this.destroy})),u("div",{class:"modal__content"},e.children)))}beforeDstroy(){this.destroyed||(this.props["event-close"]||N)()}};const Hn=`<svg width="24" height="24" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M5 13L9 17L19 7" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
`;function $n(t,e){H(u(_e,{...e,bigText:!0},e.url?u("a",{href:e.url},t):t))}function Vn(t,e){H(u(_e,{...e},t))}function Wn(t,{title:e="Action requise",yes:n="Valider",no:s="Annuler",onYes:r=()=>!0,onNo:i=()=>!1,onCancel:o=()=>null}={}){return new Promise(l=>{let c;H(u(_e,{ref:w=>{c=w},"event-close":async()=>l(await o(this))},t,u("footer",null,u("fieldset",{class:"group"},u(j,{"event-click":async()=>{l(await i(this)),c.destroy()},icon:Rt,label:s}),u(j,{"event-click":async()=>{l(await r(this)),c.destroy()},icon:Hn,label:n})))))})}function Un(t){const e=t instanceof Response?"api":t instanceof Error?"internal":"unknown";H(u(_e,{title:e==="api"?"Erreur de l’API":"Erreur"},e==="internal"&&[u("p",null,t.message),u("pre",{class:"stacktrace"},t.stack)],e==="api"&&[u("p",null,"[",t.status,"] ",t.statusText),u("pre",{class:"stacktrace"},t.message)],e==="unknown"&&[u("p",null,"Une erreur inconnue est survenue")]))}const de={bigText:$n,say:Vn,confirm:Wn,error:Un},Zn=Kn("0123456789ABCDEF",6);async function qn({force:t=!1}={}){!t&&!await de.confirm("Tout effacer ?")||(a.app.lines.set([]),a.app.inputMode.set("draw"))}function zn(){a.app.lines.update(t=>t.slice(0,t.length-1),!0),a.app.lines.current.length||a.app.inputMode.set("draw")}async function Yn(){const t=a.app.lines.current.map(e=>e.toJSON());try{const{uid:e}=await et.export(t,Zn());de.bigText(e,{url:window.location.origin+(window.location.path||"/")+"?uid="+e})}catch(e){de.error(e)}}async function Jn(t){a.api.version.get()||await new Promise(e=>a.api.version.subscribeOnce(e));try{const e=await et.import(t);a.app.lines.set(e.map(n=>new ze(n))),P.start()}catch(e){e.status&&e.status===404?de.say("Impossible de trouver l’animation demandée",{title:"Erreur"}):de.error(e)}}const te={clear:qn,undo:zn,save:Yn,load:Jn},Gn=`<svg width="24" height="24" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M3 19V5C3 3.89543 3.89543 3 5 3H16.1716C16.702 3 17.2107 3.21071 17.5858 3.58579L20.4142 6.41421C20.7893 6.78929 21 7.29799 21 7.82843V19C21 20.1046 20.1046 21 19 21H5C3.89543 21 3 20.1046 3 19Z" stroke="currentColor" stroke-width="1.5"/>
<path d="M8.6 9H15.4C15.7314 9 16 8.73137 16 8.4V3.6C16 3.26863 15.7314 3 15.4 3H8.6C8.26863 3 8 3.26863 8 3.6V8.4C8 8.73137 8.26863 9 8.6 9Z" stroke="currentColor" stroke-width="1.5"/>
<path d="M6 13.6V21H18V13.6C18 13.2686 17.7314 13 17.4 13H6.6C6.26863 13 6 13.2686 6 13.6Z" stroke="currentColor" stroke-width="1.5"/>
</svg>
`,Xn=`<svg width="24" height="24" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M6.90588 4.53682C6.50592 4.2998 6 4.58808 6 5.05299V18.947C6 19.4119 6.50592 19.7002 6.90588 19.4632L18.629 12.5162C19.0211 12.2838 19.0211 11.7162 18.629 11.4838L6.90588 4.53682Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
`,Qn=`<svg width="24" height="24" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M6 18.4V5.6C6 5.26863 6.26863 5 6.6 5H9.4C9.73137 5 10 5.26863 10 5.6V18.4C10 18.7314 9.73137 19 9.4 19H6.6C6.26863 19 6 18.7314 6 18.4Z" stroke="currentColor" stroke-width="1.5"/>
<path d="M14 18.4V5.6C14 5.26863 14.2686 5 14.6 5H17.4C17.7314 5 18 5.26863 18 5.6V18.4C18 18.7314 17.7314 19 17.4 19H14.6C14.2686 19 14 18.7314 14 18.4Z" stroke="currentColor" stroke-width="1.5"/>
</svg>
`;class es extends R{beforeRender(){this.update=this.update.bind(this),this.handleChange=this.handleChange.bind(this)}template(e,n){return u("section",{class:"timeline"},u("fieldset",{class:"group"},u(j,{icon:Qn,"store-hidden":at(a.raf.isRunning),"event-click":P.stop}),u(j,{icon:Xn,"store-hidden":a.raf.isRunning,"event-click":P.start}),u("input",{type:"range",ref:this.ref("input"),"event-input":this.handleChange,step:"1","store-value":a.raf.frameCount,"store-max":a.raf.maxDuration})),u(j,{icon:Gn,"event-click":te.save,"store-hidden":at(a.api.version),"store-disabled":X(a.app.lines,s=>!s.length)}))}afterRender(){a.raf.frameCount.subscribe(this.update)}update(){const e=a.raf.frameCount.get();this.refs.input.value=e}handleChange(e){P.stop(),a.raf.frameCount.set(+e.target.value)}}class Y extends R{beforeRender(e){this.update=this.update.bind(this),this.state={value:e["store-value"]||M(((e.values||[])[0]||{}).value)}}template(e,n){return u("div",{class:fe("switcher",e.class)},e.values.map((s,r)=>u(j,{...s,ref:this.refArray("buttons"),"event-click":()=>this.handleChange(this.props.values[(r+1)%this.props.values.length])})))}afterMount(){this.state.value.subscribe(this.update),this.update()}update(){const e=this.props.values.findIndex(({value:n})=>n===this.state.value.current);for(let n=0;n<this.refs.buttons.length;n++)this.refs.buttons[n].state.isHidden.set(n!==e)}handleChange(e){(this.props["event-change"]||N)(e.value),this.state.value.set(e.value)}}const vt=`<svg width="24" height="24" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
`,ts=`<svg width="24" height="24" viewBox="0 0 24 24" stroke-width="1.5" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M20 9L18.005 20.3463C17.8369 21.3026 17.0062 22 16.0353 22H7.96474C6.99379 22 6.1631 21.3026 5.99496 20.3463L4 9" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M21 6L15.375 6M3 6L8.625 6M8.625 6V4C8.625 2.89543 9.52043 2 10.625 2H13.375C14.4796 2 15.375 2.89543 15.375 4V6M8.625 6L15.375 6" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
`,ns=`<svg width="24" height="24" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M13.8476 13.317L9.50515 18.2798C8.70833 19.1905 7.29167 19.1905 6.49485 18.2798L2.15238 13.317C1.49259 12.563 1.49259 11.437 2.15238 10.683L6.49485 5.72018C7.29167 4.80952 8.70833 4.80952 9.50515 5.72017L13.8476 10.683C14.5074 11.437 14.5074 12.563 13.8476 13.317Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M13 19L17.8844 13.3016C18.5263 12.5526 18.5263 11.4474 17.8844 10.6984L13 5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M17 19L21.8844 13.3016C22.5263 12.5526 22.5263 11.4474 21.8844 10.6984L17 5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
`,ss=`<svg width="24" height="24" viewBox="0 0 24 24" stroke-width="1.5" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M4.5 8C8.5 8 11 8 15 8C15 8 15 8 15 8C15 8 20 8 20 12.7059C20 18 15 18 15 18C11.5714 18 9.71429 18 6.28571 18" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M7.5 11.5C6.13317 10.1332 5.36683 9.36683 4 8C5.36683 6.63317 6.13317 5.86683 7.5 4.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
`,rs=`<svg width="24" height="24" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M9 2L15 2" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M12 10L12 14" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M12 22C16.4183 22 20 18.4183 20 14C20 9.58172 16.4183 6 12 6C7.58172 6 4 9.58172 4 14C4 18.4183 7.58172 22 12 22Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
`;class is extends R{beforeRender(){this.state={hasNoLines:X(a.app.lines,e=>!e.length)}}template(e,n){return u("section",{class:"toolbar"},u("fieldset",null,u(Y,{"store-value":a.app.inputMode,values:[{icon:_t,label:"Dessin",value:"draw","store-disabled":n.hasNoLines},{icon:ns,label:"Tampon",value:"paste"}]}),u("fieldset",{class:"group"},u(Y,{"store-value":a.app.drawMode,values:a.DRAW_MODES.get()}),u(Y,{values:a.LINE_WIDTHS.get().map(({name:s,value:r})=>({value:r,icon:vt,class:`disc disc-${s}`})),"event-change":s=>{a.app.style.update(r=>({...r,lineWidth:s}),!0)}}),u(Y,{values:a.COLORS.get().map(({label:s,value:r})=>({value:r,icon:vt,class:"disc",style:`--color: ${r}`})),"event-change":s=>{a.app.style.update(r=>({...r,strokeStyle:s}),!0)}})),u(Y,{values:a.FILL_MODES.get().map(({value:s})=>({value:s,icon:rs,label:s.replace(/(→)/g,"&thinsp;$1&thinsp;")})),"event-change":s=>a.app.fillMode.set(s)})),u("fieldset",null,u(Y,{class:"view-mode",values:a.VIEW_MODES.get(),"store-value":a.app.viewMode}),u("fieldset",{class:"group"},u(j,{icon:ss,"store-disabled":n.hasNoLines,"event-click":te.undo}),u(j,{icon:ts,"store-disabled":X(a.app.lines,s=>!s.length),"event-click":te.clear}))))}}class os extends R{template(e){return u("main",{class:"app","store-data-view-mode":a.app.viewMode},u(is,null),u("div",{class:"app__main"},u(Rn,{"store-disabled":X(a.app.inputMode,n=>n!=="draw")}),u(Tn,{"store-disabled":X(a.app.inputMode,n=>n!=="paste")}),u(Bn,null)),u(es,null))}}const ls=`<svg width='100%' height='100%' viewBox='0 0 116 100'>
  <path d='M57.734,82.319C39.884,82.319 25.414,67.85 25.414,50C25.414,32.15 39.884,17.681 57.734,17.681C75.584,17.681 90.053,32.15 90.053,50C90.053,67.85 75.584,82.319 57.734,82.319M86.603,-0L28.867,-0L0,50L28.867,100L86.603,100L115.47,50L86.603,-0Z' />
</svg>
`;class wt extends R{beforeRender(e){this.handleClick=this.handleClick.bind(this),this.state={isClickable:A(e.clickable!==!1)}}template(e,n){return u("section",{class:"splashscreen","store-class-is-clickable":n.isClickable,"event-click":this.handleClick},u("div",{class:"splashscreen__content"},u("div",{class:"splashscreen__icon",innerHTML:ls}),u(j,{label:e.text||"Nouveau dessin"})))}async handleClick(){this.state.isClickable.get()&&(document.body.requestFullscreen&&await document.body.requestFullscreen(),this.destroy())}}var Fe=typeof navigator<"u"?navigator.userAgent.toLowerCase().indexOf("firefox")>0:!1;function Ie(t,e,n,s){t.addEventListener?t.addEventListener(e,n,s):t.attachEvent&&t.attachEvent("on".concat(e),function(){n(window.event)})}function jt(t,e){for(var n=e.slice(0,e.length-1),s=0;s<n.length;s++)n[s]=t[n[s].toLowerCase()];return n}function Tt(t){typeof t!="string"&&(t=""),t=t.replace(/\s/g,"");for(var e=t.split(","),n=e.lastIndexOf("");n>=0;)e[n-1]+=",",e.splice(n,1),n=e.lastIndexOf("");return e}function as(t,e){for(var n=t.length>=e.length?t:e,s=t.length>=e.length?e:t,r=!0,i=0;i<n.length;i++)s.indexOf(n[i])===-1&&(r=!1);return r}var he={backspace:8,"⌫":8,tab:9,clear:12,enter:13,"↩":13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,ins:45,insert:45,home:36,end:35,pageup:33,pagedown:34,capslock:20,num_0:96,num_1:97,num_2:98,num_3:99,num_4:100,num_5:101,num_6:102,num_7:103,num_8:104,num_9:105,num_multiply:106,num_add:107,num_enter:108,num_subtract:109,num_decimal:110,num_divide:111,"⇪":20,",":188,".":190,"/":191,"`":192,"-":Fe?173:189,"=":Fe?61:187,";":Fe?59:186,"'":222,"[":219,"]":221,"\\":220},T={"⇧":16,shift:16,"⌥":18,alt:18,option:18,"⌃":17,ctrl:17,control:17,"⌘":91,cmd:91,command:91},qe={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey",shiftKey:16,ctrlKey:17,altKey:18,metaKey:91},x={16:!1,18:!1,17:!1,91:!1},b={};for(var be=1;be<20;be++)he["f".concat(be)]=111+be;var g=[],mt=!1,Bt="all",St=[],xe=function(e){return he[e.toLowerCase()]||T[e.toLowerCase()]||e.toUpperCase().charCodeAt(0)},cs=function(e){return Object.keys(he).find(function(n){return he[n]===e})},us=function(e){return Object.keys(T).find(function(n){return T[n]===e})};function Ft(t){Bt=t||"all"}function pe(){return Bt||"all"}function fs(){return g.slice(0)}function ds(){return g.map(function(t){return cs(t)||us(t)||String.fromCharCode(t)})}function hs(t){var e=t.target||t.srcElement,n=e.tagName,s=!0;return(e.isContentEditable||(n==="INPUT"||n==="TEXTAREA"||n==="SELECT")&&!e.readOnly)&&(s=!1),s}function ps(t){return typeof t=="string"&&(t=xe(t)),g.indexOf(t)!==-1}function gs(t,e){var n,s;t||(t=pe());for(var r in b)if(Object.prototype.hasOwnProperty.call(b,r))for(n=b[r],s=0;s<n.length;)n[s].scope===t?n.splice(s,1):s++;pe()===t&&Ft(e||"all")}function vs(t){var e=t.keyCode||t.which||t.charCode,n=g.indexOf(e);if(n>=0&&g.splice(n,1),t.key&&t.key.toLowerCase()==="meta"&&g.splice(0,g.length),(e===93||e===224)&&(e=91),e in x){x[e]=!1;for(var s in T)T[s]===e&&(B[s]=!1)}}function ws(t){if(typeof t>"u")Object.keys(b).forEach(function(o){return delete b[o]});else if(Array.isArray(t))t.forEach(function(o){o.key&&Ke(o)});else if(typeof t=="object")t.key&&Ke(t);else if(typeof t=="string"){for(var e=arguments.length,n=new Array(e>1?e-1:0),s=1;s<e;s++)n[s-1]=arguments[s];var r=n[0],i=n[1];typeof r=="function"&&(i=r,r=""),Ke({key:t,scope:r,method:i,splitKey:"+"})}}var Ke=function(e){var n=e.key,s=e.scope,r=e.method,i=e.splitKey,o=i===void 0?"+":i,l=Tt(n);l.forEach(function(c){var f=c.split(o),d=f.length,w=f[d-1],C=w==="*"?"*":xe(w);if(b[C]){s||(s=pe());var y=d>1?jt(T,f):[];b[C]=b[C].filter(function(p){var k=r?p.method===r:!0;return!(k&&p.scope===s&&as(p.mods,y))})}})};function yt(t,e,n,s){if(e.element===s){var r;if(e.scope===n||e.scope==="all"){r=e.mods.length>0;for(var i in x)Object.prototype.hasOwnProperty.call(x,i)&&(!x[i]&&e.mods.indexOf(+i)>-1||x[i]&&e.mods.indexOf(+i)===-1)&&(r=!1);(e.mods.length===0&&!x[16]&&!x[18]&&!x[17]&&!x[91]||r||e.shortcut==="*")&&e.method(t,e)===!1&&(t.preventDefault?t.preventDefault():t.returnValue=!1,t.stopPropagation&&t.stopPropagation(),t.cancelBubble&&(t.cancelBubble=!0))}}}function bt(t,e){var n=b["*"],s=t.keyCode||t.which||t.charCode;if(B.filter.call(this,t)){if((s===93||s===224)&&(s=91),g.indexOf(s)===-1&&s!==229&&g.push(s),["ctrlKey","altKey","shiftKey","metaKey"].forEach(function(p){var k=qe[p];t[p]&&g.indexOf(k)===-1?g.push(k):!t[p]&&g.indexOf(k)>-1?g.splice(g.indexOf(k),1):p==="metaKey"&&t[p]&&g.length===3&&(t.ctrlKey||t.shiftKey||t.altKey||(g=g.slice(g.indexOf(k))))}),s in x){x[s]=!0;for(var r in T)T[r]===s&&(B[r]=!0);if(!n)return}for(var i in x)Object.prototype.hasOwnProperty.call(x,i)&&(x[i]=t[qe[i]]);t.getModifierState&&!(t.altKey&&!t.ctrlKey)&&t.getModifierState("AltGraph")&&(g.indexOf(17)===-1&&g.push(17),g.indexOf(18)===-1&&g.push(18),x[17]=!0,x[18]=!0);var o=pe();if(n)for(var l=0;l<n.length;l++)n[l].scope===o&&(t.type==="keydown"&&n[l].keydown||t.type==="keyup"&&n[l].keyup)&&yt(t,n[l],o,e);if(s in b){for(var c=0;c<b[s].length;c++)if((t.type==="keydown"&&b[s][c].keydown||t.type==="keyup"&&b[s][c].keyup)&&b[s][c].key){for(var f=b[s][c],d=f.splitKey,w=f.key.split(d),C=[],y=0;y<w.length;y++)C.push(xe(w[y]));C.sort().join("")===g.sort().join("")&&yt(t,f,o,e)}}}}function ms(t){return St.indexOf(t)>-1}function B(t,e,n){g=[];var s=Tt(t),r=[],i="all",o=document,l=0,c=!1,f=!0,d="+",w=!1;for(n===void 0&&typeof e=="function"&&(n=e),Object.prototype.toString.call(e)==="[object Object]"&&(e.scope&&(i=e.scope),e.element&&(o=e.element),e.keyup&&(c=e.keyup),e.keydown!==void 0&&(f=e.keydown),e.capture!==void 0&&(w=e.capture),typeof e.splitKey=="string"&&(d=e.splitKey)),typeof e=="string"&&(i=e);l<s.length;l++)t=s[l].split(d),r=[],t.length>1&&(r=jt(T,t)),t=t[t.length-1],t=t==="*"?"*":xe(t),t in b||(b[t]=[]),b[t].push({keyup:c,keydown:f,scope:i,mods:r,shortcut:s[l],method:n,key:s[l],splitKey:d,element:o});typeof o<"u"&&!ms(o)&&window&&(St.push(o),Ie(o,"keydown",function(C){bt(C,o)},w),mt||(mt=!0,Ie(window,"focus",function(){g=[]},w)),Ie(o,"keyup",function(C){bt(C,o),vs(C)},w))}function ys(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"all";Object.keys(b).forEach(function(n){var s=b[n].filter(function(r){return r.scope===e&&r.shortcut===t});s.forEach(function(r){r&&r.method&&r.method()})})}var Ne={getPressedKeyString:ds,setScope:Ft,getScope:pe,deleteScope:gs,getPressedKeyCodes:fs,isPressed:ps,filter:hs,trigger:ys,unbind:ws,keyMap:he,modifier:T,modifierMap:qe};for(var He in Ne)Object.prototype.hasOwnProperty.call(Ne,He)&&(B[He]=Ne[He]);if(typeof window<"u"){var bs=window.hotkeys;B.noConflict=function(t){return t&&window.hotkeys===B&&(window.hotkeys=bs),B},window.hotkeys=B}[{key:"space",description:"Jouer ou stopper l’animation",callback:P.toggle},{key:"left",description:"Reculer d’une image",callback:()=>{P.stop(),a.raf.frameCount.update(t=>Math.max(0,t-1))}},{key:"shift+left",description:"Reculer de 10 images",callback:()=>{P.stop(),a.raf.frameCount.update(t=>Math.max(0,t-10))}},{key:"right",description:"Avancer d’une image",callback:()=>{P.stop(),a.raf.frameCount.update(t=>Math.min(t+1,a.raf.maxDuration.get()))}},{key:"shift+right",description:"Avancer de 10 images",callback:()=>{P.stop(),a.raf.frameCount.update(t=>Math.min(t+10,a.raf.maxDuration.get()))}},{key:"cmd+z",description:"Effacer le dernier dessin",callback:te.undo},{key:"cmd+x",description:"Tout effacer",callback:te.clear},{key:"w",description:"Afficher/masquer les dessins à venir",callback:()=>a.app.viewMode.update(t=>t==="wireframe"?"preview":"wireframe")},{key:"tab",description:"Afficher / cacher l’interface",callback:t=>{t.preventDefault(),a.app.viewMode.update(e=>e==="no-ui"?"wireframe":"no-ui")}}].map(Cs);function Cs(t){return t.callback&&!t.disabled&&B(t.key,e=>{t.filter&&t.filter(e)||(e.preventDefault(),e.stopPropagation(),t.callback(e))}),t}console.log("1.0.2-staging");const Ct=new URLSearchParams(window.location.search).get("uid");(async()=>{if(et.polling.start(),Ct){const{components:t}=H(u(wt,{text:"Chargement…",clickable:!1}));await te.load(Ct),t[0].destroy()}else H(u(wt,null));H(u(os,null))})();
